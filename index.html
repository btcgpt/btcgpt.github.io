<!DOCTYPE html>
<html>

<head>
    <title>BTCGPT</title>
    <meta name="description" content="BTCGPT predicts the price of Bitcoin.">
    <meta property="og:title" content="BTCGPT">
    <meta property="og:description" content="BTCGPT predicts the price of Bitcoin.">
    <meta property="og:image" content="./images/btc.png">
    <meta property="og:image:width" content="100">
    <meta property="og:image:height" content="100">
    <meta charset="UTF-8">
    <meta name="naver-site-verification" content="089e77bc8defc2d01087f8b2da5f8b7d4ec68efe" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700&display=swap">
    <link rel="stylesheet" href="./css/style.css?v=2.0">
    <link rel="icon" type="image/png" href="./images/btc.svg">    
    <!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3319067300509450" crossorigin="anonymous"></script> -->
</head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QC6EQ2XQ12"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-QC6EQ2XQ12');
</script>

<body>
    <header>
        <div class="container">
            <svg width="64" height="64">
                <image href="./images/btc.svg" style="opacity: 0.8;" />
            </svg>
            <h1 class="btcgpt">BTCGPT</h1>
            <h1>üöÄüåï</h1>
            <div id="id_text">
                <p style="text-align: center;" class="btcgpt">&nbsp;</p>
                <p style="text-align: center;" class="notice">&nbsp;</p>
                <p style="text-align: center;" class="notice">&nbsp;</p>
            </div>
        </div>
    </header>

    <video autoplay loop muted playsinline id="video-background" poster="./videos/up.png">
        <source src="./videos/rocket_launch.mp4" type="video/mp4">
    </video>

    <div id="id_container" class="container">

        <div class="card">
            <p>Hourly Forecast</p>
            <div id="id_hour">
                <p class="info" id="id_hour_next">
                    <span class="price"></span>
                    <span class="percent"></span>
                    <h4 class=""><span class="datetime"></span><span id="id_hour_time_left" class="datetime"></span></h4>
                </p>
                <p class="info" id="id_hour_now">
                    <span class="price"></span>
                    <span class="percent"></span>
                    <h4 class=""><span class="datetime" id="id_hour_datetime"></span></h4>
                </p>
                <p class="info">
                    <p class="gap" id="id_hour_gap"><span>&nbsp;</span></p>
                </p>
                <p class="info">
                    <div id="id_hour_desc">
                        <p class="desc"><span></span></p>
                        <p class="desc"><span></span></p>
                    </div>    
                </p>
            </div>
            <canvas class="chart" id="id_hourchart" height="150"></canvas>
        </div>


        <div class="card">
            <p>Daily Forecast</p>
            <div id="id_day">
                <p class="info" id="id_day_next">
                    <span class="price"></span>
                    <span class="percent"></span>
                <h4 class=""><span class="datetime"></span></h4>
                </p>
                <p class="info" id="id_day_now">
                    <span class="price"></span>
                    <span class="percent"></span>
                    <h4 class=""><span class="datetime" id="id_day_datetime"></span></h4>
                </p>
                <p class="info">
                    <p class="gap" id="id_day_gap"><span>&nbsp;</span></p>
                </p>
                <p class="info">
                    <div id="id_day_desc">
                        <p class="desc"><span></span></p>
                        <p class="desc"><span></span></p>
                    </div>
                </p>
            </div>
            <canvas class="chart" id="id_daychart" height="150"></canvas>
        </div>

        <div class="card">
            <p>Weekly Forecast</p>
            <div id="id_week">
                <p class="info" id="id_week_next">
                    <span class="price"></span>
                    <span class="percent"></span>
                <h4 class=""><span class="datetime"></span></h4>
                </p>
                <p class="info" id="id_week_now">
                    <span class="price"></span>
                    <span class="percent"></span>
                    <h4 class=""><span class="datetime" id="id_week_datetime"></span></h4>
                </p>
                <p class="info">
                    <p class="gap" id="id_week_gap"><span>&nbsp;</span></p>
                </p>
                <p class="info">
                    <div id="id_week_desc">
                        <p class="desc"><span></span></p>
                        <p class="desc"><span></span></p>
                    </div>
                </p>
            </div>
            <canvas class="chart" id="id_weekchart" height="150"></canvas>
        </div>

        <div class="card text">
            <p class="">What is BTCGPT?</p>
            <p>
                <span class="">
                    BTCGPT is a deep learning model that predicts the future price of Bitcoin based on past Bitcoin
                    prices, as well as other relevant data such as trading volumes, market capitalization, and news
                    sentiment analysis. These models are typically trained using historical data and fine-tuned with
                    more recent data to improve their accuracy.
                    It is important to note that while these models may provide valuable insights, they are not
                    foolproof and cannot predict the future with complete certainty. Market conditions, economic
                    factors, and other unpredictable variables can impact the price of Bitcoin and other assets.
                    Therefore, it is recommended that investors use BTCGPT's predictions as just one tool to inform
                    their investment decisions and always conduct their own research before making any investment
                    decisions.
                </span>
            </p>
        </div>

        <div class="card text">
            <p class="">Why are the hourly, daily and weekly price predictions different?</p>
            <p>
                Ideally, we would like all models to provide the same predictions, but in reality, due to
                differences in the training data and model architecture, they may produce different results. The
                hourly and daily models use more recent data and incorporates more short-term market trends, while
                the weekly model uses a longer time frame and focuses on broader market trends.    
            </p>
        </div>

        <!-- <div class="card">
            <p class="sm_text">What is Average Directional Accuracy?</p>
            <p>
                <span class="sm_text">
                    Directional accuracy(DA) is a metric that measures how closely the predicted price and the actual
                    price of an asset move in the same direction. For example, if the predicted price for the next day
                    is higher and the actual price also increases, the DA result would be True (1). However, if the
                    actual price moves in the opposite direction, the result would be False (0).
                    The N-day average directional accuracy (ADA) is calculated by summing up the DA results over N days
                    and dividing the total by N. For example, if the DA results for the last 5 days are [1, 0, 1, 1, 1],
                    the 5-day ADA would be (1+0+1+1+1)/5 = 0.8.
                    The chart displays the moving ADA over a 5-day period.
                </span>
            </p>
        </div> -->
        <div class="card text">
            <p class="">Updates.</p>
            <p>‚úÖ BTCGPT(alpha) launched. (2023-04-11)</p>
            <p>‚úÖ accuracy improved, bug fix. (2023-04-17)</p>
            <p>‚úÖ added: analysis metrics. (2023-04-19)</p>
            <p>‚úÖ updated: ux text. (2023-04-20)</p>
            <p>‚úÖ updated: prediciton model (2023-04-26)</p>
            <p>‚úÖ added: hourly forecast. (2023-04-26)</p>
            <p>‚úÖ BTCGPT(beta) launched. (2023-04-28)</p>
            <p>‚úÖ updated: ux text & charts (2023-05-06)</p>
        </div>

        <div class="card text">
            <p class="">Contact.</p>

            <!-- <p>
                <span class="notice_orange">
                    Please ask any questions on r/Bitcoin.
                    <a href="https://www.reddit.com/r/Bitcoin/comments/12lf2vn/btcgpt_predicts_bitcoin_price_your_fun_bitcoin/" target="_blank" style="color: rgb(255, 255, 255);">Go to Bitcoin r/Bitcoin</a>.
                </span>
            </p>
            <p>
                <span class="notice_orange">
                    Previous post was deleted by moderator but comments can still be seen here.
                    <a href="https://www.reddit.com/r/Bitcoin/comments/12kj6gq/btcgpt_predicts_bitcoin_price_your_fun_bitcoin/" target="_blank" style="color: rgb(255, 255, 255);">Go to Bitcoin r/Bitcoin</a>.
                </span>
            </p> -->

            <!-- <p>
                <span class="notice_orange">
                    Please ask any questions on BitcoinTalk.
                    <a href="https://bitcointalk.org/index.php?topic=5448757.0" target="_blank" style="color: rgb(255, 255, 255);">Go to BitcoinTalk.</a>.
                </span>
            </p> -->
            <p>If you have any questions, please send me an email.</p> 
            <p>btcgpt @ gmail.com</p>            
        </div>

    </div>

    <footer class="text" style="text-align: center;">
        <div style="text-align: center;"><img src="./images/captainbtc.jpg" alt="CaptainBTC" style="width: 60px; height: 60px; margin-right: 0px; border-radius: 50%;"></div>
        &copy; 2023 BTCGPT.INFO
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@2.2.1/dist/chartjs-plugin-annotation.min.js"></script>

    <script>
        charts = []
        function create_charts() {
            Chart.defaults.color = "white";

            ctx = document.getElementById('id_hourchart').getContext('2d');
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: 'actual',
                        // data: data.day.actual,
                        //fill: true,
                        borderWidth: 1,
                        pointRadius: 2,
                        //tension: 0.5,
                        backgroundColor: 'rgba(0, 255, 0, 1.0)',
                        borderColor: 'rgba(0, 255, 0, 1)'
                    },
                    {
                        label: 'pred:past',
                        //data: data.day.pred_past,
                        fill: true,
                        borderWidth: 1,
                        //pointStyle: false,
                        pointRadius: 2,
                        // hidden: true, // Set the dataset to be hidden initially
                        backgroundColor: 'rgba(33, 146, 255, 0.8)',
                        borderColor: 'rgba(33, 146, 255, 1)'
                    },
                    {
                        label: 'now',
                        //data: data.day.now_s,
                        //fill: true,
                        borderWidth: 1,
                        //pointRadius: 2,
                        pointRadius: [2, 2],
                        backgroundColor: 'rgba(255, 255, 255, 1.0)',
                        borderColor: 'rgba(0, 255, 0, 1)'
                        // hidden: true
                    },
                    {
                        id: "future",
                        label: 'pred:future',
                        //data: data.day.pred_future,
                        fill: true,
                        borderWidth: 1,
                        pointRadius: 2,
                        backgroundColor: 'rgba(33, 146, 255, 0.3)',
                        borderColor: 'rgba(33, 146, 255, 1)'
                    }]
                },
                options: {
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 8
                                }
                            },
                            display: false
                        },
                        y: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 8
                                },
                                beginAtZero: false,
                            },
                            // position: "right"
                        },
                    },
                    plugins: {
                        title: {
                            display: false,
                            text: 'Daily Forecast',
                            font: {
                                size: 16, // Set the title font size here
                                weight: 'normal' // Set the title font weight to normal
                            }
                        },
                        legend: {
                            display: true,
                            position: 'bottom',
                            labels: {
                                font: {
                                    size: 10
                                },
                                boxWidth: 10,
                                filter: item => item.text !== 'now'
                            }
                        }
                    },
                }
            });
            charts.push(chart)

            ctx = document.getElementById('id_daychart').getContext('2d');
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: 'actual',
                        // data: data.day.actual,
                        //fill: true,
                        borderWidth: 1,
                        pointRadius: 2,
                        backgroundColor: 'rgba(0, 255, 0, 1.0)',
                        borderColor: 'rgba(0, 255, 0, 1)'
                    },
                    {
                        label: 'pred:past',
                        //data: data.day.pred_past,
                        fill: true,
                        borderWidth: 1,
                        //pointStyle: false,
                        pointRadius: 2,
                        // hidden: true, // Set the dataset to be hidden initially
                        backgroundColor: 'rgba(255, 159, 64, 0.8)',
                        borderColor: 'rgba(255, 159, 64, 1)'
                    },
                    {
                        label: 'now',
                        //data: data.day.now_s,
                        //fill: true,
                        borderWidth: 1,
                        pointRadius: [2, 2],
                        backgroundColor: 'rgba(255, 255, 255, 1.0)',
                        borderColor: 'rgba(0, 255, 0, 1)'
                    },
                    {
                        label: 'pred:future',
                        //data: data.day.pred_future,
                        fill: true,
                        borderWidth: 1,
                        pointRadius: 2,
                        backgroundColor: 'rgba(255, 159, 64, 0.3)',
                        borderColor: 'rgba(255, 159, 64, 1)'
                    }]
                },
                options: {
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 8
                                }
                            },
                            display: false
                        },
                        y: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 8
                                },
                            },
                            // position: "right"
                        },
                    },
                    plugins: {
                        title: {
                            display: false,
                            text: 'Daily Forecast',
                            font: {
                                size: 16, // Set the title font size here
                                weight: 'normal' // Set the title font weight to normal
                            }
                        },
                        legend: {
                            display: true,
                            position: 'bottom',
                            labels: {
                                font: {
                                    size: 10 // Set the legend label font size here
                                },
                                boxWidth: 10,
                                filter: item => item.text !== 'now'
                            }
                        },
                    }
                }
            });
            charts.push(chart)

            ctx = document.getElementById('id_weekchart').getContext('2d');
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: 'actual',
                        //data: data.week.actual,
                        //fill: true,
                        borderWidth: 1,
                        pointRadius: 2,
                        backgroundColor: 'rgba(0, 255, 0, 1)',
                        borderColor: 'rgba(0, 255, 0, 1)'
                    },
                    {
                        label: 'pred:past',
                        //data: data.week.pred_past,
                        fill: true,
                        borderWidth: 1,
                        //pointStyle: false,
                        pointRadius: 2,
                        //hidden: true, // Set the dataset to be hidden initially
                        backgroundColor: 'rgba(255, 99, 132, 0.8)',
                        borderColor: 'rgba(255, 99, 132, 1)'
                    },
                    {
                        label: 'now',
                        //data: data.week.now_s,
                        //fill: true,
                        borderWidth: 1,
                        pointRadius: [2, 2],
                        backgroundColor: 'rgba(255, 255, 255, 1.0)',
                        borderColor: 'rgba(0, 255, 0, 1)'
                    },
                    {
                        label: 'pred:future',
                        //data: data.week.pred_future,
                        fill: true,
                        borderWidth: 1,
                        pointRadius: 2,
                        backgroundColor: 'rgba(255, 99, 132, 0.3)',
                        borderColor: 'rgba(255, 99, 132, 1)'
                    }]
                },
                options: {
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 8
                                }
                            },
                            display: false
                        },
                        y: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 8
                                }
                            },
                            // position: "right"                            
                        },
                    },
                    plugins: {
                        title: {
                            display: false,
                            text: 'Weekly Forecast',
                            font: {
                                size: 16, // Set the title font size here
                                weight: 'normal' // Set the title font weight to normal
                            }
                        },
                        legend: {
                            display: true,
                            position: 'bottom',
                            labels: {
                                font: {
                                    size: 10 // Set the legend label font size here
                                },
                                boxWidth: 10,
                                filter: item => item.text !== 'now'                                
                            }
                        },
                    }
                }
            });
            charts.push(chart)

            container = document.getElementById('id_container');
            resizeObserver = new ResizeObserver(() => {
                charts.forEach(chart => {
                    chart.resize();
                });
            });
            resizeObserver.observe(container);

        }

        function get_info(data) {

            info = {}

            next_price = data.pred_future.slice(0)[0]['y']
            last_price = data.actual.slice(-1)[0]['y']
            next_percent = (next_price - last_price) * 100 / last_price

            info.next_price = formatPrice(next_price)
            info.next_percent = formatPercent(next_percent) + data.percent

            if (next_percent < 0) {
                info.c_next = "down"
            } else if (next_percent > 0) {
                info.c_next = "up"
            } else {
                info.c_next = "eq"
            }

            if (next_price > last_price) {
                info.actual_to_next = "up üöÄ"
            } else if (next_price < last_price) {
                info.actual_to_next = "down üò±"
            } else {
                info.actual_to_next = "same üòê"
            }

            pred_past_price = data.pred_past.slice(-1)[0]['y']
            if (next_price > pred_past_price) {
                info.past_to_next = "up üöÄ"
            } else if (next_price < pred_past_price) {
                info.past_to_next = "down üò±"
            } else {
                info.past_to_next = "same üòê"
            }

            info.datetime = data.pred_future[0]['x']

            info.id_next = data.id_next
            info.id_desc = data.id_desc
            info.id_time_left = data.id_time_left

            // gap_avg_abs(data.actual, data.pred_past)

            return info
        }

        function gap_avg_abs(y_true, y_pred) {
            let l_true = [];
            let l_pred = [];

            y_true.forEach((item, index) => {
                l_true.push(item['y']);
                l_pred.push(y_pred[index]['y']);
            });

            let abs_diff = l_true.reduce((sum, val, index) => sum + Math.abs(val - l_pred[index]) / val, 0);
            let avg_abs_diff = abs_diff * 100 / l_true.length;

            console.log("Average absolute difference:", formatPercent(avg_abs_diff));
        }

        last_data = null
        last_data_str = null

        utc_hour = null
        utc_day = null
        utc_week = null

        function reload() {
            //fetch the JSON data from the file
            fetch("https://raw.githubusercontent.com/btcgpt/data/main/output.json", { cache: 'no-cache' })
            .then(response => response.json())
            .then(data => {
                temp = JSON.stringify(data);
                if (temp == last_data_str) {
                    //console.log("no change")
                    return
                }
                last_data = data
                last_data_str = temp

                // prepare to display
                data.hour.id_next = "id_hour_next"
                data.day.id_next = "id_day_next"
                data.week.id_next = "id_week_next"

                data.hour.id_desc = "id_hour_desc"
                data.day.id_desc = "id_day_desc"
                data.week.id_desc = "id_week_desc"

                data.hour.id_time_left = "id_hour_time_left"
                data.day.id_time_left = "id_day_time_left"
                data.week.id_time_left = "id_week_time_left"

                data.hour.percent = "% +1h üîÆ"
                data.day.percent = "% +1d üîÆ"
                data.week.percent = "% +1w üîÆ"

                data.hour.next = "+1h"
                data.day.next = "+1d"
                data.week.next = "+1w"

                mylist = [data.hour, data.day, data.week]
                mylist.forEach(item => {

                    info = get_info(item)

                    temp = `
                    <p class="info">
                        <span class="price ${info.c_next}">${formatPrice(info.next_price)}</span>
                        <span class="percent ${info.c_next}">${formatPercent(info.next_percent)}</span>
                        <h4 class="${info.c_next}">
                            <span class="datetime">${info.datetime}:00 UTC,</span>
                            <span id="${info.id_time_left}" class="datetime"> 00:00:00</span>
                        </h4>
                    </p>`

                    document.getElementById(info.id_next).innerHTML = temp;

                    temp = `
                        <div>                      
                            <p class="desc"><span>actual to ${item.next}: ${info.actual_to_next}</span></p>
                            <p class="desc"><span>pred:past to ${item.next}: ${info.past_to_next}</span></p>
                        </div>
                    `
                    document.getElementById(info.id_desc).innerHTML = temp;
                })


                charts[0].data.datasets[0].data = data.hour.actual;
                charts[0].data.datasets[1].data = data.hour.pred_past;
                charts[0].data.datasets[2].data = data.hour.now_s;
                charts[0].data.datasets[3].data = data.hour.pred_future;

                charts[1].data.datasets[0].data = data.day.actual;
                charts[1].data.datasets[1].data = data.day.pred_past;
                charts[1].data.datasets[2].data = data.day.now_s;
                charts[1].data.datasets[3].data = data.day.pred_future;

                charts[2].data.datasets[0].data = data.week.actual;
                charts[2].data.datasets[1].data = data.week.pred_past;
                charts[2].data.datasets[2].data = data.week.now_s;
                charts[2].data.datasets[3].data = data.week.pred_future;

                charts.forEach(chart => {
                    chart.update();
                });

                // charts.forEach(chart => {
                //     chart.destroy();
                // });
                // charts = []
            })
        }

        create_charts();

        reload();

        setInterval(reload, 1 * 5 * 1000);

        function getNowDateString(now) {
            const year = now.getUTCFullYear();
            const month = (now.getUTCMonth() + 1).toString().padStart(2, '0');
            const day = now.getUTCDate().toString().padStart(2, '0');
            const hours = now.getUTCHours().toString().padStart(2, '0');
            const minutes = now.getUTCMinutes().toString().padStart(2, '0');
            const seconds = now.getUTCSeconds().toString().padStart(2, '0');
            const time_now = `${year}-${month}-${day} ${hours}:${minutes}:${seconds} UTC`;

            return time_now;
        }

        function getCountdownDateString(date, now) {
            targetTime = new Date(date);
            //currentTime = new Date();
            var utc = new Date(now.getTime() + now.getTimezoneOffset() * 60000);
            timeDiff = targetTime.getTime() - utc.getTime();
            hours = Math.floor(timeDiff / (1000 * 60 * 60)).toString().padStart(2, '0');
            minutes = Math.floor((timeDiff / (1000 * 60)) % 60).toString().padStart(2, '0');
            seconds = Math.floor((timeDiff / 1000) % 60).toString().padStart(2, '0');

            time = `-${hours}:${minutes}:${seconds}`;
            if (hours < 0) {
                time = "Predicting...üßòüèª"
            }
            return time
        }

        function updateTime() {
            if (last_data != null) {
                now = new Date();
                document.getElementById('id_hour_time_left').innerHTML = getCountdownDateString(last_data.hour.pred_future[0]['x'], now);
                document.getElementById('id_day_time_left').innerHTML = getCountdownDateString(last_data.day.pred_future[0]['x'], now);
                document.getElementById('id_week_time_left').innerHTML = getCountdownDateString(last_data.week.pred_future[0]['x'], now);

                date_now = getNowDateString(now)
                document.getElementById('id_hour_datetime').innerHTML = date_now
                document.getElementById('id_day_datetime').innerHTML = date_now
                document.getElementById('id_week_datetime').innerHTML = date_now
            }

            charts.forEach(chart => {
                if (chart.data.datasets[2].pointRadius[1] == 2) {
                    chart.data.datasets[2].pointRadius[1] = 5
                } else {
                    chart.data.datasets[2].pointRadius[1] = 2
                }
                chart.update();
            });
        }
        // setInterval(updateTime, 1000);


        LANGUAGES = ["zh", "es", "en", "ar", "pt", "bn", "ru", "ja", "ko", "fr", "de", "it", "tr", "hi", "fa", "th", "pl", "ur", "nl"]
        function detectLanguage() {
            const userLang = navigator.language || navigator.userLanguage;
            const langCode = userLang.split('-')[0];
            if (LANGUAGES.includes(langCode)) {
                return langCode;
            }
            return 'en';
        }

        function updateContent(language) {
            fetch('./text/language.json', { cache: 'no-cache' })
            .then(response => response.json())
            .then(data => {
                const content = data[language];
                const textElement = document.querySelector('#id_text');
                // Ìï¥Îãπ Ïñ∏Ïñ¥Ïóê ÎåÄÌïú ÎÇ¥Ïö©ÏúºÎ°ú Î¨∏ÏÑú Í∞ùÏ≤¥Î•º Î≥ÄÍ≤ΩÌï©ÎãàÎã§.
                textElement.innerHTML = `
                <p style="text-align: center;" class="btcgpt">${content.text}</p>
                <p style="text-align: center;" class="notice">${content.notice1}</p>            
                <p style="text-align: center;" class="notice">${content.notice2}</p>`;
            })
            .catch(error => {
                console.error('Error fetching language data:', error);
            });
        }

        window.onload = function () {
            const language = detectLanguage();
            updateContent(language);
        };

        function formatPrice(price) {
            return price.toLocaleString('en-US', {
                style: 'currency',
                currency: 'USD',
            }).replace(/\.(\d\d)/, '');
        }

        function formatPercent(number) {
            return number.toLocaleString('en-US', {
                style: 'decimal',
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
        }

        last_price = null
        function getPrice() {
            const url = 'https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT';
            fetch(url)
                .then(response => response.json())
                .then(data => {

                    if (last_data != null) {

                        price_now = Math.round(data.price);
                        if(last_price != price_now) {
                            last_price = price_now

                            // hour
                            price_last = last_data.hour.actual.slice(-1)[0]['y']
                            percent_now = (price_now - price_last) * 100 / price_last;
                            percent_now = parseFloat(percent_now.toFixed(2));
                            // if (percent_now < 0) {
                            //     c_now = "down"
                            // } else if (percent_now > 0) {
                            //     c_now = "up"
                            // } else {
                            //     c_now = "eq"
                            // }
                            c_now = "eq"

                            temp = `
                                    <span class="price ${c_now}">${formatPrice(price_now)}</span>
                                    <span class="percent ${c_now}">${formatPercent(percent_now)}% now</span>
                                    <h4 class="${c_now}"><span class="datetime" id="id_hour_datetime"></span></h4>`
                            document.getElementById('id_hour_now').innerHTML = temp

                            price_next = last_data.hour.pred_future.slice(0)[0]['y']
                            percent_next = (price_next - price_last) * 100 / price_last;
                            price_percent_gap = percent_now - percent_next
                            price_percent_gap = parseFloat(price_percent_gap.toFixed(2));
                            if (price_percent_gap > 0)
                                direction = 'up'
                            else if (price_percent_gap < 0)
                                direction = 'down'
                            else
                                direction = 'eq'
                            temp = `<span class="${direction}">gap: ${formatPercent(price_percent_gap)}% </span>`
                            document.getElementById('id_hour_gap').innerHTML = temp

                            // day
                            price_last = last_data.day.actual.slice(-1)[0]['y']
                            percent_now = (price_now - price_last) * 100 / price_last;
                            percent_now = parseFloat(percent_now.toFixed(2));
                            // if (percent_now < 0) {
                            //     c_now = "down"
                            // } else if (percent_now > 0) {
                            //     c_now = "up"
                            // } else {
                            //     c_now = "eq"
                            // }
                            c_now = "eq"

                            temp = `
                                    <span class="price ${c_now}">${formatPrice(price_now)}</span>
                                    <span class="percent ${c_now}">${formatPercent(percent_now)}% now</span>
                                    <h4 class="${c_now}"><span class="datetime" id="id_day_datetime"></span></h4>`
                            document.getElementById('id_day_now').innerHTML = temp                            

                            // temp = `
                            //     <span class="price">${formatPrice(price_now)}</span>
                            //     <span class="percent">${formatPercent(percent_now)}% now</span>
                            // `
                            // document.getElementById('id_day_now').innerHTML = temp

                            price_next = last_data.day.pred_future.slice(0)[0]['y']
                            percent_next = (price_next - price_last) * 100 / price_last;
                            price_percent_gap = percent_now - percent_next
                            price_percent_gap = parseFloat(price_percent_gap.toFixed(2));
                            if (price_percent_gap > 0)
                                direction = 'up'
                            else if (price_percent_gap < 0)
                                direction = 'down'
                            else
                                direction = 'eq'
                            temp = `<span class="${direction}">gap: ${formatPercent(price_percent_gap)}%</span>`
                            document.getElementById('id_day_gap').innerHTML = temp

                            // week
                            price_last = last_data.week.actual.slice(-1)[0]['y']
                            percent_now = (price_now - price_last) * 100 / price_last;
                            percent_now = parseFloat(percent_now.toFixed(2));
                            // if (percent_now < 0) {
                            //     c_now = "down"
                            // } else if (percent_now > 0) {
                            //     c_now = "up"
                            // } else {
                            //     c_now = "eq"
                            // }
                            c_now = "eq"

                            temp = `
                                    <span class="price ${c_now}">${formatPrice(price_now)}</span>
                                    <span class="percent ${c_now}">${formatPercent(percent_now)}% now</span>
                                    <h4 class="${c_now}"><span class="datetime" id="id_week_datetime"></span></h4>`
                            document.getElementById('id_week_now').innerHTML = temp

                            price_next = last_data.week.pred_future.slice(0)[0]['y']
                            percent_next = (price_next - price_last) * 100 / price_last;
                            price_percent_gap = percent_now - percent_next
                            price_percent_gap = parseFloat(price_percent_gap.toFixed(2));
                            if (price_percent_gap > 0)
                                direction = 'up'
                            else if (price_percent_gap < 0)
                                direction = 'down'
                            else
                                direction = 'eq'
                            temp = `<span class="${direction}">gap: ${formatPercent(price_percent_gap)}%</span>`
                            document.getElementById('id_week_gap').innerHTML = temp

                            for (chart of charts) {
                                chart.data.datasets[2].data[1]['y'] = price_now
                                chart.update();
                            }
                        }

                        updateTime()
                    }
                })
                .catch(error => console.error(error));
        }
        getPrice();
        setInterval(getPrice, 1000);

    </script>

</body>

</html>